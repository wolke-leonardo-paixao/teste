#!/bin/bash

# Obter o nome do branch atual
current_branch=$(git rev-parse --abbrev-ref HEAD)

# Definir a vari√°vel de ambiente BRANCH_NAME
mysql_query="SET @branch_name = '$current_branch';"

# Adicionar o restante do script SQL
mysql_query+="SET @view_name = CASE "
mysql_query+="    WHEN @branch_name = 'dev' THEN 'dlh-dev-brlm-qr8' "
mysql_query+="    WHEN @branch_name = 'prod' THEN 'dlh-prd-brlm-zcb' "
mysql_query+="    ELSE 'Branch desconhecida.' "
mysql_query+="END;"

mysql_query+="$(sed "s/@view_name/$view_name/g" script.sql)"

# Executar o comando SQL no MySQL
echo "$mysql_query" | docker exec -i mysql mysql -u root -p123456
